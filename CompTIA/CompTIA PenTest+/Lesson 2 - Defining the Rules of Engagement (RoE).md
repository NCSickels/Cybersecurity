## Lesson Introduction
---
A structured PenTest will help ensure the organization has enacted best practices for handling customer data. The team needs to be aware of any environmental and location restrictions that will govern their behavior during the exercise. In addition, you’ll need to obtain a target list of in-scope assets. During the assessment, the team may be asked to conduct additional tests. However, it’s essential that the team is aware of the consequences of testing beyond the defined scope. Once you have gathered all relevant information, you’ll need to validate the scope of engagement so that all parties agree on the terms. Finally, prior to beginning the PenTest, the team must prepare several legal documents that outline the scope and terms of the project.

## Lesson Objectives
---
In this lesson, you will:

- Recognize environmental considerations as to resources in the network, applications in the cloud, along with location restrictions that may impact testing.
- Outline target list/in-scope assets by gathering logical and physical diagrams, Internet protocol (IP) addresses, and domains.
- Define and validate the rules of engagement for safely conducting the Penetration Testing exercise within an organization.
- Prepare legal documents related to the Penetration Testing exercise.

## Topic 2A - Assess Environmental Considerations
---
> [!note] Exam Objectives Covered
> *1.1 Compare and contrast governance, risk, and compliance reports.*
> *1.2 Explain the importance of scoping and organizational/customer requirements.*

Prior to beginning the PenTest, the team needs to have a clear definition of several aspects of the environment they will be testing. In this section, we’ll review the importance of defining the project scope, which can include on-site networks, specific applications, or resources in the cloud. The team will also need to define in-scope assets such as IP address ranges, application programming interfaces (APIs), and whether the assets are first-party or third-party hosted. In addition, because of the complexities of specific laws, the team needs to be aware of their location along with any restrictions that might apply.

Let’s start with outlining the project scope.

### Defining the Project Scope
---
When determining the scope of a PenTesting exercise, all stakeholders will define specifically what is to be included or excluded during the testing process. Properly scoping the test and providing specific attributes will help everyone understand the expectations. In addition to a more cost-effective approach, the team will have a clear idea as to when the testing is complete.

Through the requirements analysis process, the team will determine what specific environments are to be considered. Once the targets are identified, this will better determine the scope and type of attacks the team will attempt.

PenTesting is often done in response to regulatory or other industry requirements and generally includes testing the networks, along with any cloud services and/or applications.

#### Assessing the Network
Today's networks are complex, and the team will need to understand the customers' priorities. In addition to testing the wired *local area network (LAN)*, the team will most likely be asked to test the *wireless local area networks (WLANs)*, as they have become more pervasive. Because of this, the team will need to include a discussion with the stakeholders on how to proceed for both the wired and wireless networks.

In addition to the network, the team should determine whether or not it is necessary to test the company’s applications for underlying security issues.

#### Evaluating Web and/or Mobile Applications.
It’s common for a company to have a web presence today; however, many web applications and components have vulnerabilities, which can lead to data compromise. Because of this, the team may be asked to PenTest the company's web applications and services.

Prior to testing, the team should define some guidelines as follows:

1. The client will need to either provide a percentage or discrete value of total number of web pages or forms that require user interaction.
2. Depending on the application, the team should obtain a variety of roles and permissions so each role can be tested. For example, if running in user context, you'll want to see if you can escalate privilege once an application is compromised.

Mobile applications also can be targets, because they can contain sensitive data such as credit card numbers. In addition, they have many vulnerabilities such as insecure communications and weak cryptography and represent an additional attack vector.

As a result, the team may also be tasked to test mobile apps as part of the scope. When deriving the scope for mobile apps, the team should gather information on which applications to test, platform specifications, and possibly specific scenarios.

Network boundaries have blurred, and many companies are using cloud resources, such as: *Software as a Service (SaaS)*, *Infrastructure as a Service (IaaS)*, or *Platform as a Service (PaaS)* . A diagram outlining the key differences between these cloud computing models can be found in [[CompTIA Pentest+.canvas|CompTIA Pentest+]]. Next let’s see why it may be a part of the project scope to assess cloud resources.

#### Testing Cloud Resources
Companies recognize the vulnerabilities that exist when dealing with cloud assets. Because of this, many have turned to professional PenTesters to test the strength of the security mechanisms that are in place.

Prior to testing in the cloud, the team will need to obtain the proper permissions from the provider and determine what type of testing will be allowed. For example, testing might include virtual machines, and any *application programming interfaces (API)*. In addition, the team will need to get a complete understanding of what is hosted, and how the cloud is used, so they can properly identify points of weakness. However, even with permission, the team needs to understand that some portions (or some testing) may simply be off limits.

Along with defining the project scope, the team will need to outline specific assets that are in scope, as we’ll see next.

### Targeting In-Scope Assets
---
Many times, the PenTest is done in a limited time frame. Because of this, the stakeholders will need to be specific as to what assets will be included in the scope. Once they are clearly defined, the testers will be able to focus on the in-scope assets.

Some of the assets can include:

- **Internet Protocol (IP)** addresses—includes appropriate network ranges, and possible autonomous system Number(s) (ASN) the organization is using.
- **Domain and/or subdomains** within the organizations, such as example.com and ftp.example.com.
- **Application programming interfaces (APIs)**, which could be either public facing applications or those that allow access to the details of a specific user.
- **Users** can also be an in-scope asset, as they are susceptible to social engineering, and are generally considered to be the easiest attack vector. In addition, they will generally have access to resources that might be restricted to outside parties.
- **Service Set Identifiers (SSID)** can be targets when an attacker is attempting to access a wireless network. However, using an evil twin or other Wi-Fi attack generally requires close physical proximity to the premises.

The team will also want to recognize the physical locations that are to be considered an in-scope asset, and whether it is on-site or off-site.

#### Physical Locations
| **Location** | **Description** |
| :--: | ---- |
| *On-Site* | An asset that is physically located where an attack is being carried out. On-site testing can include attempting to compromise a business's physical barriers to gain access to systems, server rooms, infrastructure, and employees. |
| *Off-Site* | An asset that provides a service for a company but is not necessarily located at the same place, such as remote offices and/or satellite locations. These locations can be a softer target as they are less likely to have as many security controls as headquarters. |
Another consideration is whether the team will test external or internal assets as follows:

- **External assets** are visible on the Internet, such as a website, web application, email, or DNS server. An external asset is not a good candidate for attacks that require direct access to the network segment, such as sniffing or ARP poisoning.
- **Internal assets** can be accessed from within the organization. Access to these resources can be achieved by the efforts of either a malicious insider or an external hacker who has gained credentials through a phishing attack. If direct access to the internal network can be established, this asset is an excellent candidate for all attack types.

The team will also need to define how the assets are hosted.

#### Defining First-Party and Third-Party Hosted
| **Type** | **Description** |
| :--: | ---- |
| *First-party hosted* | This includes assets that are hosted by the client organization. In some cases, first-party hosted assets might be easier to attack than third-party hosted services, as most companies do not have the same resources, expertise, or security focus as a service provider. |
| *Third-party hosted* | This includes assets that are hosted by a vendor or partner of the client organization, such as cloud-based hosting. This type of asset is not an impossible target, however, established providers are generally more likely to have more stringent controls in place. In contrast, smaller, newer hosting companies may have fewer resources and less security expertise and may be easier to attack than larger, more mature providers. |
Once the team has identified the scope and the assets that are to be tested, they must also review with the stakeholders any restrictions that will influence their testing.

### Identifying Restrictions
---
When conducting PenTesting, the team must recognize there may be restrictions on what they can test, and methods used to achieve their goal. Restrictions can include laws and privacy requirements that can influence the process. Once the restrictions are identified, the team will need to monitor all activity to ensure compliance.

First let’s review how country, state, and local laws can impact testing.

#### Recognizing Country, State, and Local Laws
Even if the stakeholder’s have fully sanctioned a PenTest, there may be restrictions that will impact the type of testing the team can complete. These can include country, state, and local laws, that restrict or controls the technology, tools and methods used during the PenTesting process. Some examples include:

- Adhering to proper data handling techniques for any data obtained during testing, as any exposure may be a violation of a law or statute that relates to data privacy.
- Techniques that are part of the process of exploiting computer systems, such as port scanning, may be in violation of a law.

In addition, many companies and organizations now have specific policies that regulate PenTesting activities. As a result, the team will need to be aware of any particular restrictions adopted by the company or organization that is undergoing PenTesting.

When dealing with laws that affect the PenTesting process, the team also has to recognize restrictions on the use of specific tools.

#### Regulating the Use of Tools
In the United States, export controls regulate the shipment or transfer of certain items such as software, technology, and/or services outside of the country. In addition, other nations might have restrictions on sharing certain items outside of their borders.

For example, Wireshark is a powerful open-source protocol analysis tool that has the ability to decrypt many of the protocols used to conceal data, such as IPsec, Kerberos, and SSL/TLS. Wireshark is primarily distributed in the United States. Because of this, it falls under the U.S. encryption export regulations.

There may also be specific language prohibiting, creating, or distributing computer security software, that is designed to actively attack a system. In addition, in some jurisdictions it may be illegal to jam a Wi-Fi signal or use a lockpick set.

Along with specific contractual requirements, other legal differences that depend on your organization's environment can affect the PenTesting process. Because of this, the team will need to thoroughly research any laws that govern the use of tools, to ensure all testing is within legal guidelines.

## Topic 2B - Outline the Rules of Engagement (RoE)
---
> [!note] Exam Objectives Covered
> *1.2 Explain the importance of scoping and organizational/customer requirements.*
> *1.3 Given a scenario, demonstrate an ethical hacking mindset by maintaining professionalism and integrity.*

During the kick-off meeting, the team will learn essential information that will allow them to safely conduct the PenTest. Part of this process is outlining the rules of engagement. In this section, we’ll define the rules which describe client expectations, along with the details of what type of testing will be done by the team. We’ll also discuss ways to select the type and strategy used during testing and then summarize by stressing the importance of validating the scope of the engagement.

To begin, we’ll see how as part of defining the rules of engagement, the organization should provide several details that might influence the testing process.

### Providing the Details
---
At this point, the team should have the stakeholders spell out all requirements and agree on the terms before testing begins. All parties should be encouraged to keep the lines of communication open and clarify any issues. For example, the stakeholders may ask questions such as:

- Will the PenTesting team agree to work with an in-house staff member designated as a monitor?
- Can we suspend testing activities at any time?
- Is the PenTesting team willing to communicate with the Internet Service Provider (ISP) about the large number of external scans they might do during testing?

When sitting down with the stakeholders, the team should ask open-ended questions that will remove any ambiguity as to the mode and methods used to test the systems. No detail is too small. Some information is more critical. For example, the stakeholders might share that they had had a breach in the past, or they feel there may be an *advanced persistent threat (APT)* within the network.

The team will need to assess other related details, such as an approved timeline, and any restrictions that will influence the testing process.

Let’s start with the importance of a timeline.

#### Adhering to a Timeline
A timeline represents a series of events that transpire within a discrete period of time. When defining a timeline for a PenTest, this will outline the specific parameters along with an estimation of time needed to complete all testing that is included in the contract.

So that the organization understands the procedure for PenTesting, it's best to sit down with the stakeholders and outline how the team will proceed with the test.

When scheduling, the team will explain to the stakeholders how testing during normal business hours will help assess the organization’s reaction to attacks. However, there may also be time of day restrictions when no testing is allowed, as it may impact potential services and cause an outage.

After discussing the timeline restrictions, they may be defined in the contract as follows:

_"Testing for 515web.net will be conducted from 8:00 A.M. to 6:00 P.M. U.S. Eastern Time, Monday through Friday unless otherwise stated within the individual test plan."_

The team should discuss the general methodology and realistic estimation of time needed for each of the tasks that need to be conducted. In addition, the timeline should indicate the individuals or teams responsible for performing those tasks. Once complete, the team will share the timeline with the stakeholders and adjust as needed during testing for any unexpected events.

Professional PenTesters are expected to know how to conduct tests in a quick and efficient way. Using good time management skills will increase the team's productivity and efficiency.

The goal is to build a long-lasting relationship with the client. Because of this, the team should conduct themselves in a professional manner. Some suggestions include:

- Focus on the task at hand
- Avoid distractions
- Adhere to the timeline
- Keep status meetings short and to the point.

Each team member should know when to ask for help, and not spend hours on a single task that should only take 45 minutes.

In addition to time, there may be other restrictions that will affect the testing process.

#### Understanding the Restrictions
Once the main objectives are outlined, the team will want to review other variables as they relate to testing. While the scope may have outlined the assets and the environment, the team will need to understand the restrictions that can impact testing, that include:

- **Allowable tests**—to further define the scope, the team will need to determine exactly what's being tested, and what is not. Identify acceptable actions during tests such as social engineering and physical PenTesting.
- **Adhering to the scope**—The legal documents will define what locations, systems, applications, or other potential targets are to be included or excluded. There may be an instance while testing when someone asks someone on the team if they could test another subnetwork. The team member should explain that if the test is not specifically in the scope, they cannot do the test due to legal reasons.
- **Recognizing other restrictions**—The details of the PenTest may also include other restrictions such as possible technical or location constraints. For example, there may be a legacy system that has had several issues with automated scanning.
- **Limit invasiveness based on scope**—What is being tested, and what is not? Define the acceptable actions, such as social engineering and physical security tasks. In addition, if planning an invasive attack, such as a *Denial of Service attack (DoS attack)* as part of the testing, have the stakeholder define any restrictions that might impact fragile systems.
- **Limit the use of tools to a particular engagement**—In some cases, the use of tools is defined by some governing body that outlines specifically what the team is to use when conducting the test. In that case, the team will be presented with a list of tools that can be used for a particular engagement.

The team should address any other variables that will impact testing. For example, if there is an installation in a different country that needs to be included in the test, is there technology available to access the remote location? If an on-site visit is required, the parties should agree to the amount of travel needed to conduct the PenTest at the remote location.

Sample documentation defines acceptable tools is as follows:

_"The following list includes all 515support.com approved vulnerability assessment, penetration testing and network monitoring tools that are either commercial, noncommercial, or custom built. If additional tools are needed for a specific test, the team must submit a rationale for using the tool, along with a request for approval. Approval must be granted prior to using the tool on the production network."_

In most cases, everyone will have thought out all possible variables. However, in some cases, once testing begins, the stakeholders may need to identify either a prohibited system, specific time of day, or IP address range that is to be excluded from testing. If that happens, the stakeholders will need to notify the team and request a change to the terms of the contract.

At some point, the team will need to plan a strategy for conducting the PenTest. The strategy will include the rationale for the test, and whether they will operate in a known or unknown environment during testing.

### Choosing a Type and Strategy
---
While scoping organizational requirements, the team will need to gather information from the stakeholders to learn more about their needs and the objectives of the PenTest. In addition, the team will have some options when deciding the type of assessment and the strategy that will be used. Variables can include whether the environment is known or unknown or how many details the PenTest team is given prior to testing. Once the team has this information, they will then be better armed to proceed with the PenTest.

Let’s first review the types of PenTesting assessments.

#### Comparing Assessment Types
Although there can be several ways your team can conduct a PenTest, some of the more common types of assessments are as follows:

- **Compliance based** assessments are used as part of fulfilling the requirements of a specific law or standard, such as GDPR, HIPAA, or PCI DSS. For example, PCI DSS has clearly defined guidelines on what should be included in the assessment. Others provide guidance on how you can ensure your organization is in compliance. For example, the HIPAA Security Rule has a crosswalk that maps to the NIST Cybersecurity Framework. 
- **Red team/blue team-based** assessments is a method that uses two opposing teams in a PenTest or incident response exercise:
	- **Red Team**—represents the "hostile" or attacking team.
	- **Blue Team**—represents the defensive team.

With this type of assessment, the goal is to see if your (red) team is able to circumvent security controls. In addition, it is a good way to determine how the security (blue) team will respond to the attack.

> [!important] Red-team Assessments
> Note: Unlike other types of penetration tests, red-team assessments are *not* intended to provide details of all the security flaws a target has. This means that red-team assessments are unlikely to provide as complete a view of flaws in the environment, but they can be very useful as a security exercise to train incident responders or to help validate security design practices.

- **Goals-based/objectives-based** assessments have a particular purpose or reason. For example, before implementing a new *point of sale (PoS)* system that accepts credit cards, the PenTesting team might test the system for any security issues prior to implementation. Other examples include validation of a new security design, testing an application or service infrastructure before it enters production, and assessing the security of an organization that has recently been acquired.

Below is an example of the client of a mature organization with a strong security posture. 

**Objectives:**
1. Identify system misconfigurations and network weaknesses.
    1. Focus on exterior systems.
2. Determine the effectiveness of endpoint detection and response systems.
3. Evaluate overall security posture and response.
    1. SIEM and detection measures.
    2. Remediation.
    3. Segmentation of DMZ and internal servers.
4. Use of white cards is permitted depending on downtime and length.
5. Evaluate the impact of data exposure and exfiltration.

**Scope:**
1. System downtime is not permitted under any circumstances.
    1. Any form of DDoS or DoS is prohibited.
    2. Use of any harmful malware is prohibited; this includes ransomware and other variations.
2. Exfiltration of PII is prohibited. Use arbitrary exfiltration data.
3. Attacks against systems within 10.0.4.0/22 are permitted.
4. Attacks against systems within 10.0.12.0/22 are prohibited.
5. Bean Enterprises will closely monitor interactions with the DMZ and critical/production systems.
    1. Any interaction with "`*.bethechange.xyz`" is prohibited.
    2. All interaction with "`*.globalenterprises.zyx`" is permitted.

In addition to determining the type of assessment the team will need to complete, they will also need to determine the strategy, as to the amount of information the team is given prior to the assessment.

#### Selecting a Strategy
When the team meets with the stakeholders, they will determine the type of strategy they will take, along with how much information they are given prior to conducting the PenTest. The three common strategies are outlined as follows:

- **Unknown environment** testing is when the PenTesting team is completely in the dark; no information is presented to the team prior to testing. This type of assessment will mimic what an actual threat actor will need to do before launching any attacks. The team will need to scan available network resources and identify live hosts, listening ports, and running services prior to exploiting any assets.
- **Partially known environment** testing is commonly used to test web applications for security vulnerabilities. The PenTesting team is given some information, such as internal functionality and code so they can focus on testing for any issues related to system defects or improper usage of applications. For example, a partially unknown test might be run after any software defects are repaired.
- **Known environment** testing is when the PenTesting team is given all details of the network and applications. The test is commonly done with the perspective of the user. Because all of the details are transparent, the team can focus on the test. Colloquially known as "white box", "crystal box", or "full knowledge" environments.

Defining the rules of engagement sets the tone for the entire assessment. Although the details can be complex, and at times overwhelming, a properly run PenTest will help reduce risk, strengthen an organizations security posture, and ensure compliance with regulations.

Once the team outlines the specifics of the test, the next step is to confirm the details of the scope of the engagement.

### Validating the Scope of the Engagement
---
After the team has gathered the particulars of the PenTest, they will need to review and confirm all requirements, scope, and details of the engagement.

The team should reconfirm details such as whether they have appropriate system backups and recovery procedures in the unlikely event that a partial or full recovery is needed. In addition, double check that the team knows who to notify if they identify a high-risk vulnerability.

Make sure to question the client on any vague areas, so there is no confusion. In addition, ask a few general questions, as this can give everyone a moment to reflect.

Some elements to review can include:

- Scope and in-scope assets
- What is _excluded_
- Strategy: unknown, partially known, or known environment testing
- Timeline to complete testing and any constraints
- Any restrictions or applicable laws
- Third-party providers, services, or off-site locations
- Communication and updates

Have the team members and stakeholders complete an independent read-through to ensure everything discussed is covered and clearly defined.

You’ll want to stress the fact that the PenTest is valid only at the point in time it is conducted. In addition, reiterate how the chosen scope and methodology can impact the comprehensiveness of the test.

Although the team may feel anxious to begin the assessment, validating the scope of the engagement is an essential step to ensure that all aspects are covered. This will minimize the need to adjust the contract after testing has begun.

A brief summary of the Rules of Engagement sections that could be included are detailed below. Note that all sections may not be required, as this document would be tailored to the client's needs.

|                **Section Name**                 | **Section Details**                                                                                   |
| :---------------------------------------------: | ----------------------------------------------------------------------------------------------------- |
|               *Executive Summary*               | Overarching summary of all <br>contents and authorization within <br>RoE document.                    |
|                    *Purpose*                    | Defines why the Rules of Engagement <br>document is used.                                             |
|                  *References*                   | Any references used throughout the <br>RoE document (HIPAA, ISO, etc.)                                |
|                     *Scope*                     | Statement of the agreement to <br>restrictions and guidelines.                                        |
|                  *Definitions*                  | Definitions of technical terms <br>used throughout the RoE document.                                  |
| *Rules of Engagement and <br>Support Agreement* | Defines obligations of both parties and <br>general technical expectations of <br>engagement conduct. |
|                  *Provisions*                   | Define exceptions and additional <br>information from the Rules of Engagement.                        |
| *Requirements, Restrictions, <br>and Authority* | Define specific expectations of the red team cell.                                                    |
|                 *Ground Rules*                  | Define limitations of the red team cell's interactions.                                               |
|   *Resolution of Issues/Points<br>of Contact*   | Contains all essential personnel involved in an engagement.                                           |
|                 *Authorization*                 | Statement of authorization for the engagement.                                                        |
|                   *Approval*                    | Signatures from both parties approving all subsections of the preceding document.                     |
|                   *Appendix*                    | Any further information from preceding subsections.                                                   |

> [!warning] It's important to remember that Rules of Engagement documents are legally binding contracts between the PenTesters and the Client. Failure to follow them can lead to serious repercussions.

> [!Important] NIST provides an outline and more in-depth explanation of Rules of Engagement documents in the [[NIST 800-115 - Technical Guide to Information Security Testing and Assessment.pdf | Technical Guide to Information Security Testing and Assessment (NIST 800-115)]]

## Topic 2C - Prepare Legal Documents
---
> [!note] Exam Objectives Covered
> *1.1 Compare and contrast governance, risk, and compliance reports.*

Once everyone has agreed to the terms, the team will need to draw up the legal documents that will define the body of work the team will perform. In this section, we’ll review some of the documentation that may be required prior to testing that includes a Nondisclosure Agreement and Statement of Work along with Master Service Agreement. While each of the documents have their own specific purpose, they will outline specifics such as customer obligations and termination rights for both parties along with any other relevant details.

Let’s start with the need to ensure confidentiality.

### Ensuring Confidentiality
---
When testing a system, the team will want to avoid creating a liability, by ensuring everyone takes the necessary precautions to protect the confidentiality of the data. During the planning stage, each team member must have a clear understanding of what data to avoid. This is important, as specific laws may apply to the business unit or application affected while testing.

For example, the following will influence how data is handled:

- **The Gramm-Leach-Bliley Act (GLBA)** requires financial institutions ensure the security and confidentiality of client information and take steps to keep customer information secure.
- **The Driver's Privacy Protection Act** governs the privacy and disclosure of personal information gathered by state Departments of Motor Vehicles.
- **The Health Insurance Portability and Accountability Act (HIPAA)** Privacy Rule establishes national standards to protect the privacy of individuals’ medical records.

Ensuring confidentiality will require all data be handled appropriately. The team will need to review specific guidelines on how best to protect the data. Guidelines include requiring that any collected data be encrypted during and after the test and describing how the team should dispose of the data after the PenTest is complete.

Because of confidentiality requirements, each team member will most likely have to sign a *Nondisclosure agreement (NDA)*. An NDA is a legal document that stipulates the parties will not share confidential information, knowledge, or materials with unauthorized third parties.

One of the most important elements of planning and scoping is the final document(s) that explicitly gives the team authorization to conduct the PenTest exercise. Let’s see what’s involved, next.

### Giving Permission to Attack
---
PenTesting simulates the approach of an unauthorized hacker attacking a system in order to assess the security of an organization.

In most cases, an organization will contact a professional PenTesting team to conduct an Ethical Hacking exercise. After meeting with the client, scoping the project, and gathering all requirements, the team will need to obtain formal permission to attack.

It’s important to make the client aware that the PenTest team will take precautionary efforts to protect the systems, however, certain types of testing may cause damage. For example, when testing internal resources on a Microsoft network, if the team is able to breach the Active Directory, this can potentially affect the server’s ability to communicate. This in turn can have widespread disruption of multiple services.

In most cases, serious system damage is rare. However, the PenTesting team must take all necessary precautions to minimize damage as they will most likely want to avoid any liability. Reassure the client by having anyone involved with the PenTest sign a written agreement to act within the stated requirements and agree to protect the company for any violations of the law during testing.

Once everyone has reviewed all scoping requirements related to the PenTesting exercise, the team will need to create final documentation that provides written authorization to conduct the testing activities. Most documents include (but are not limited to) the following information:

- Names of the entity or Individuals that are authorized to perform the PenTest
- What specific networks, hosts, and applications are to be included in the PenTest
- The validity period of the authorization
- Proper data handling techniques
- Reporting guidelines and chain of command
- Guidelines that outline when testing is to be terminated

The legal documents will provide the written authorization for the team to simulate attacks on the organization.

Another key document that will govern all of their future transactions or future agreements between the PenTesting team and the client is a Master Service Agreement (MSA).

#### Understanding the Master Service Agreement
Conducting a PenTest for an organization is a business arrangement, and all terms of the test should be clearly defined. The ***Master Service Agreement (MSA)*** is a contract that establishes precedence and guidelines for any business documents that are executed between two parties. It can be used to cover recurring costs and any unforeseen additional charges that may occur during a project without the need for an additional contract.

Some of the elements should include details on the following:

- Project scope and a definition of the work that is to be completed
- Compensation specifics that include invoicing and any reports required when submitted
- Requirements for any permits, licensing, or certifications
- Safety guidelines and environmental concerns
- Insurances such as general and liability.

Prior to signing, all parties should carefully read the MSA to ensure that the agreement does not conflict with any other contracts or insurance policies. In addition, the MSA must be modifiable as there may be necessary changes that may occur in the future.

A professionally written MSA will help avoid disputes between parties and outline a clear ending to the PenTest engagement.

Once you have an MSA to solidify the legal terms between the parties, you can then create one or more ***Statement of Work (SOW)*** to outline project-specific services and payment terms.

Next, let’s discuss the Statement of Work.

#### Outlining the Statement of Work
The ***Statement of Work (SOW)*** is a document that defines the expectations for a specific business arrangement. It typically includes a list of deliverables, responsibilities of both parties, payment milestones, schedules, and other terms.

For anyone collaborating with or contracted to work on a project, the SOW provides the details on the work that the client has agreed to pay. As a result, it has a direct impact on team activities. It also can be used by the PenTest team to charge for out-of-scope requests and additional client-incurred costs.

#### Statement of Work Example

![[577-1621561323920-02_SOW_EX.png]]

Next, let’s discover what makes up the service-level agreement.
#### Preparing the Service-Level Agreement
A ***service-level agreement (SLA)*** is a contract that outlines the detailed terms under which a service is provided, including reasons the contract may be terminated.

The SLA contains everything related to the PenTest process, as it defines the level of service expected by a customer from a supplier. The document will lay out the metrics by which that service is measured, and the remedies or penalties, if any, should the agreed-on service levels not be achieved.

In addition, there may be terms for security access controls and risk assessments, along with processing requirements for confidential and private data.

There may be an engagement in which a third-party service provider, such as a cloud service platform, might be affected during the PenTest. In that case, you will need to make sure that you have proper authorization from the provider, as well as from the client.

> [!warning] The team will need to ensure that you can comply with the requirements and performance standards of any agreements that you enter into as a service provider.

Along with the terms under which a service is provided, the team will need to include any disclaimers related to the PenTest in the final documentation.

Prior to completing the document, make sure that you have identified the proper signing authority who can authorize that the PenTest can take place. This should include a statement that the undersigned is a signing authority for the organization.

Finally, it is strongly recommended that all parties arrange for legal review of the authorization document. Once everyone is comfortable with the terms of the agreement, it’s time to sign the contract(s) and begin planning the PenTest.

As we can see, there are multiple documents that define the nature of the work. No matter the title, written authorization is essential in a PenTesting engagement as they help control the amount of liability incurred by the PenTester.