## Lesson Introduction
---
Logical defenses such as access control lists, firewalls, and unified threat management systems have strengthened over the years. As a result, malicious actors have turned to a softer target, the human. That is why it’s essential that the PenTest includes social engineering so the team can test the strength of the human firewall, along with assessing the physical security aspects of the organization. In this lesson, we’ll learn how to set up a social engineering exploit and review various physical attacks such as dumpster diving, shoulder surfing, and cloning a badge. We’ll then cover some of the methods and tools used to achieve a successful attack, including the ***Social Engineering Toolkit (SET)***.

## Lesson Objectives
---
In this lesson, you will:

- Understand various methods used in social engineering to exploit the human psyche.
- Demonstrate how using charm, power, and influence, along with a variety of techniques, such as having a sense of urgency or impersonation, are used to gain the trust of a victim.
- Summarize physical attacks that can lead to more information such as dumpster diving or shoulder surfing.
- Discover the tools used to launch a social engineering attack, such as the Social Engineering Toolkit (SET) in Kali Linux.

## Topic 4A - Exploit the Human Psyche
---
> [!note] Exam Objectives Covered
> *3.6 Given a scenario, perform a social engineering or physical attack.*

Your team has successfully gathered information on the target, such as email addresses, phone numbers, and other points of contact. In addition, the team will have obtained information on individuals in the organization, including their interests, demeanor, and how they live their lives from day to day.

As a result, the next logical step after gathering people-based OSINT is social engineering, a powerful and effective tactic that deceives people into giving access and sensitive data to unauthorized parties.

In this section, you'll learn ways to leverage the information gathered to contact individuals in the organization, by using one or more techniques, and trick them into providing actionable intel. We’ll learn what’s involved in the social engineering process and how to best approach the target. We'll then compare phishing, pharming, and baiting the victim, and how best to use charm, power, and influence to obtain information or get the victim to complete some action.

Let’s start with learning the basics of social engineering.

### Using Social Engineering
---
Because of our trusting nature, malicious actors use social engineering techniques approximately 80% of the time. As a result, it is an extremely effective tactic to use during the PenTest process.

Social engineering targets various people with different job roles. Some common targets include employees who handle financial data and high-profile personnel and executives. However, anyone in the organization can be used during the PenTest exercise, as long as it is in the project scope.

Keep in mind social engineering involves exploiting human beings and the trust they place in others. The team should be aware of how your actions can affect others before leveraging the information on the people in the organization. As a result, the project scope might prohibit certain tactics, or even social engineering altogether.

Most social engineering attacks share some basic components that enable them to be effective. Because of this, the team will use several methods to evaluate and approach the target.

Prior to launching an attack, the team will need to evaluate potential targets and determine how susceptible they are to specific types of social engineering. In addition, they should also evaluate the target’s general level of awareness of technology and cybersecurity.

Social engineering tactics use psychological manipulation and exploit humans' willingness to place trust in others. Threat actors’ prey upon the victims sometimes-erroneous decision-making abilities. One tactic is to use ***pretexting***, whereby the team will communicate, whether directly or indirectly, a lie or half-truth in order to get someone to believe a falsehood. This belief can prompt the victim into committing an action they had not intended or is against their better interests.

The team might also try to get to know their target on a personal level, by using social media or other method. If the target is comfortable and friendly with someone, they might trust them. Once the team has gained this trust, the next step is to motivate the target to take some action or provide useful information.

Part of this process involves using ***elicitation***, which is acquiring data from the target in order to launch an attack. This is different than information gathered _about_ the target, in that a social engineer will attempt to learn useful information by contacting people who may provide key insights. Some techniques include:

- **Request**—a social engineer in a trusted position asks the target for information
- **Interrogation**—a social engineer poses as an authority figure to obtain actionable intel.
- **Surveys** are used to informally collect data from the target.
- **Observation**—a social engineer examines the target's behavior and day-to-day routine in a particular environment, with or without their knowledge.

Using the information from each of the various techniques can provide the social engineer with insight into how they think or act in certain situations.

Elicitation is useful when used in a variant of phishing called a ***business email compromise (BEC)***. In a BEC, an attacker will either impersonate a high-level executive or hijack their email account. They then send an email to financial personnel, requesting money via a method such as a wire transfer. Because the financial personnel will believe the request is legitimate, they will approve the transfer. At that point, the attacker will have successfully obtained a payment without stealing it directly.

An example of a BEC where someone posing as an executive solicits payment from a finance employee, as shown in the following graphic:

![[Pasted image 20240104131708.png]]
*An example of a business email compromise*

A ***hoax*** is another element of social engineering in which the attacker presents a fictitious situation as real. The following are some examples of hoaxes that may convince an unsuspecting victim:

- A pop-up that says an antivirus program has identified the presence of malware on a target's system, and in order to fix the infection the target should click a link. The hoax is that the link leads to malicious code.
- An email claiming to be from Amazon states that the target's account has been flagged for suspicious activity. The target must sign into Amazon and confirm that the account has not been compromised. The hoax is that the sign-in link goes to a pharming website that steals the user's credentials.
- A blog post claiming that most computer performance issues are the result of RAM that has not been "cleaned" often enough. The post offers steps for how to perform a "clean" operation at the command line. The hoax is that the command will format a user's storage drive, and completely wipe its contents.

As shown in the following graphic, a hoax can use a well-crafted email sent to the target:

![[Pasted image 20240104131750.png]]
*An example of a hoax email*

Next, let's review some common social engineering techniques.

### Phishing, Pharming, and Baiting the Victim
---
***Phishing*** is a social engineering attack where the malicious actor communicates with the victim from a supposedly reputable source, to try to lure the victim into divulging sensitive information. The concept of using phishing as a social engineering technique initially included email-based messaging, however, now includes using any type of communication medium.

Phishing is one of the most common and effective social engineering tactics because it’s easy to craft and distribute to the masses. Phishing leverages technical tricks—like spoofing the FROM headers in email—to make it more convincing. A number of tools, including Metasploit Pro and the ***Social Engineering Toolkit (SET)*** in Kali Linux, have built-in features that make it easy to launch a phishing campaign.

***Pharming*** is when an attacker entices the victim into navigating to a malicious web page that has been set up to look official. The site can either mimic an existing site such as a banking website or it can simply have an air of legitimacy. The victim interacts with the site in order to provide their sensitive information to the attacker, by filling out a fake "login" form with their username and password.

Another technique is ***baiting***, where an attacker will leave bait, such as an infected physical media, in an area where a victim can find the device. The goal is to get the victim to pick up the drive and then insert it into a computer so that the malware can infect the system.

A malicious actor will leverage phishing, pharming, and baiting to launch a more effective attack using several methods. First, let’s discuss how malicious actors use email to launch an attack.

#### Dispatching Email
Email is one of the original ways to send malware, and continues to be an ideal method to launch an attack. To disseminate a message to multiple victims, malicious actors use spam, which is unsolicited email, that includes advertisements, and get-rich-quick schemes. Spam can also include malvertising, which is email that looks like a normal ad, but instead includes malicious code.

Spam is often used in conjunction with phishing: the attacker sends unsolicited email to as many targets as possible, hoping that at least some users will act on them.

For a more targeted approach, an attacker can use *spear phishing*, which is a phishing attack that targets a specific person or group of people. Spear phishing attacks require that the attacker perform reconnaissance and gather specific people-based information on their targets before launching the attack. The attacker then uses what they learn about their targets' habits, interests, and job responsibilities to create a custom message. The custom email is more convincing than a generic one and has a better chance of having the target open the message and complete some action.

> [!warning] One form of spear phishing is whaling, which targets wealthy or powerful individuals, such as a CEOs of a Fortune 500 companies or a philanthropist.

In addition to email, malicious actors are using other forms of communication, such as ***Voice over IP (VoIP)*** and ***instant messaging (IM)*** in a social engineering attack. Let’s see what’s involved next.

#### Targeting the Victim Using Text or VoIP
Phishing is an effective method to disseminate malware, get the victim to click on a link or complete some action. As a result, in addition to using email to send targeted messages, malicious actors use other communication media such as VoIP and IM as well.

***Vishing*** is another term for VoIP phishing. It’s similar to regular phishing in that a hacker will call the party and request confidential information. This type of attack can be more effective, as people tend to be more trusting when they are interacting with a person on the other end of the line.

In addition to vishing, malicious actors also use ***spam over internet telephony (SPIT)*** to send unwanted messages to phone recipients. SPIT is annoying and is dangerous, as it can clog your voicemail system and can carry viruses and spyware in the message. To prevent vishing and SPIT, many VoIP companies verify and authenticate the phone number before passing the call on to the recipient. However, not everyone has this service.

Vishing and SPIT attacks are possible because software is easily available that can spoof a phone number so that it appears to be coming from a trustworthy source. In addition, the malicious actor can even disguise their voice and can send a single message to thousands of recipients at a time.

Along with email and VoIP, IM can also be used to launch an attack. Methods include:

- **Instant messaging spam (spim)** uses instant messaging to send a large volume of unsolicited messages to multiple recipients using the same IM platform.
- **Short message service (SMS)** and **SMiShing** is a phishing attack in which the attacker entices their victim through SMS text messages.

The prevalence of smartphones may make using IM more attractive to an attacker than email; however, people are more likely to ignore text messages from unknown or untrusted senders.

Other techniques used by malicious actors include baiting a victim to pick up a device or redirect someone to a malicious site. Let’s see what’s involved when using these two methods.

#### Baiting and Redirecting the Victim
As users surf the Internet, shop online, and interact with friends, they may feel more secure, as they are completing familiar tasks without having to think about their actions. Malicious actors count on this familiarity to launch an attack. For example, if you see something on the ground, you might reach down and pick up the item to take a closer look. Malicious actors use this sense of curiosity to bait victims into completing some action.

The most common form of baiting is called a ***Universal Serial Bus (USB)*** drop key attack. In this attack, a malicious actor will drop a thumb drive in a parking lot or some other public area near a workspace. An employee might notice the USB drive lying on the ground, pick it up, and plug it into their computer. Unbeknownst to them, the drive has been preloaded with malicious software that can compromise the employee's computer.

This kind of attack will rely on the victim's computer having autorun enabled so that the malicious code is executed immediately. The malware, depending on its nature, may then spread outward and start infecting other hosts on the network.

Even if autorun is not enabled, the attacker can still entice a user to manually open a file and run the malicious code on the USB drive by disguising it in the following ways:

- As something fun, such as a video game
- As something useful, such as an antivirus program
- As something mysterious, such as a file with cryptic names

Another method that employs deceitful tactics is a ***watering hole attack***, which can download and trigger an exploit on a victim without any direct contact from the malicious actor. As shown in the graphic, the malicious actor doesn’t have any direct contact with the victim:
![[Pasted image 20240104132308.png]]
*Watering hole attack*

Let’s step through the process:

1. The malicious actor identifies an insecure website frequented by the victim.
2. The malicious actor injects malicious code onto the insecure website.
3. When the victim visits the insecure website, the payload is triggered.
4. The payload is sent to the victim and infects the victim’s computer.
5. The exploit then opens a communication channel and reports back to the malicious actor.

Once on the victim’s system, the malicious actor can move through the system and then possibly pivot and access protected resources on the network.

The technique used in a watering hole attack can be used in other ways as well, such as a ***supply chain attack*** as shown in the graphic:
![[Pasted image 20240104132353.png]]
*Supply chain attack*

Although similar to a watering hole attack, a supply chain attack can have more damaging effects. Infecting the target organization can result in ***downstream liability***, as any vendors (downstream) might be harmed by the malware on the target system (upstream), which can result in serious damage.

When crafting various social engineering attacks, another method the team can use to redirect victims is ***typosquatting (URL hijacking)***. With URL hijacking, an attacker exploits the typing mistakes that users may make when attempting to navigate to a website.

URL hijacking works in the following manner:

1. A user that wants to visit CompTIA's website might type in their browser **comtpia.org** (instead of **comptia.org** ).
2. The browser has no way of knowing this was a mistake, so it sends the user to **comtpia.org**.
3. An attacker has already registered **comtpia.org** and cloned the site, which can be used as a pharming site with the hopes of collecting sensitive data.

In addition to misspellings, URL hijacking also encompasses other variations that include:

- Typing the wrong top-level domain (e.g., **comptia.gov**),
- Hyphenating the domain (**comp-tia.org**),
- Using a different form of a word (e.g., **thecomptia.org**).

Many companies have expended significant effort in combating typosquatted domains. However, it’s best practice to do a search for URL hijacking to see if the target has any similar domains that have been registered.

Next let’s take a look at various methods to gain trust in order to get the target to complete an action or divulge sensitive information.

### Employing Charm, Power, and Influence
---
In order to motivate the target, a social engineer will rely on one or more techniques to make the attack seem more authentic. Techniques can include impersonation, along with triggering an emotion such as fear, intimidation, or the need to conform.

Let’s see how this works.
#### Impersonating and Imitating
Many social engineering ploys include ***impersonation***, or the act of pretending to be someone or something. Malicious actors couple pretexting and impersonation to craft a believable scenario and impersonate various characters, such as a person of authority, coworker, or trusted organization. Prior to launching an attack, they might conduct research on a target to create a credible story to help build rapport and establish trust, and then possibly engage in some back-and-forth communication.

For example, a malicious actor might pretend to be a help desk worker and call an employee and ask them for their password so that they can reset an accounts database. If the target isn't familiar with the help desk employees or the phone number that they use, then they might not be suspicious of the request.

However, to launch a more believable ruse, the malicious actor could do some research prior to the attack and learn the names of some of the help desk personnel. That way, when the malicious actor makes the call, they could mention some names to spoof the victim to think the caller is a trusted employee.

Impersonation during a social engineering attack many times is done using the phone or email. This attack can also be effective in face-to-face interactions; however, an in-person spoof will require more setup and possibly an outfit (such as a shirt with the vendors name).

Part of the impersonation ploy involves different tactics that include:

- Leverage our need to obey an authority figure. For example, a malicious actor posing as an authority figure, such as a police officer, is often more successful at enticing a victim to perform some action they shouldn't.
- Implying scarcity to get the victim to act, as people tend to attach undue value to objects or ideas that are uncommon or otherwise difficult to obtain. For example, sending an email stating the victim is the recipient of a "secret" or "exclusive" item is more enticing to the victim than something they encounter every day.
- Promoting a sense of urgency, which is similar to scarcity, but with a time element involved. For example, a malicious actor might encourage a victim to “act quickly, as this is a limited time offer" which may prompt the victim to click on a link.
- Malicious actors also prey on fear, as it can motivate people to act in ways they normally wouldn't. For example, a malicious actor might warn the victim that they will lose money or access if they do not comply.

Another quality that malicious actors prey on is the need to comply and conform. Let’s examine ways that this is achieved.

#### Complying and Conforming
When interacting with a group, we tend to mirror the actions of others because of the need to belong. Malicious actors leverage this need when developing an exploit. Some of the characteristics that illustrate the desire to conform are social proof and likeness.

***Social proof*** is when someone copies the actions of others in order to appear competent or cooperative in the eyes of others. For example, after a major catastrophe, everyone you know on social media is donating to the cause, and a list of names and their donation is displayed. You might donate as well so your name appears, and you will have conformed with your peers.

***Likeness*** is another conformity quality. Demonstrating that you can conform with the group can increase your likability. For example, imagine you work with a group that goes to square dancing every Saturday night. When asked to join, you might go as well, even though you are not fond of square dancing. Malicious actors leverage this quality to get someone to complete some action.

## Topic 4B - Summarize Physical Attacks
---
> [!note] Exam Objectives Covered
> *3.6 Given a scenario, perform a social engineering or physical attack.*

A PenTest exercise will many times include an assessment of the physical aspects of the organization and can include the target’s premises or any physical device belonging to the client organization. In this section, we’ll review how to exploit physical security by using methods such as tailgating, dumpster diving, and other techniques to gain access to the private network.

Let’s start with an overview and best practice methods to exploit the target’s physical security defenses.

### Exploiting Physical Security
---
Assessing an organization’s physical security many times is part of a comprehensive PenTest. Prior to beginning the test, the team will want to review the project scope and outline the specifics of exactly what is to be included when testing. Details include the parameters and priorities, what assets are to be assessed, and the targets’ point of contact.

Some of the tasks the team might attempt can include:

- Taking pictures of restricted areas and proprietary equipment
- Stealing devices, documents, and electronic data
- Accessing restricted systems
- Planting malicious devices such as keystroke loggers
- Bypassing security cameras and locks
- Gaining access to server room and utility closets

Once everyone is clear about the objectives, the team will want to evaluate any physical security controls and internal vulnerabilities and defenses that might be in place on the target's premises:

- Door and hardware locks, both physical and electronic
- Video surveillance cameras inside and outside of a building
- Security guards inside and outside of a building or patrolling an area
- Lighting that makes it easier to spot an intruder at night
- Physical barriers such as fences, gates, and mantraps
- Alarms and motion sensors

Now that you have a grasp on what’s involved in the physical security assessment, let’s outline ways to bypass security measures.

### Circumventing Security
---
Prior to attempting a physical security breach of a building, the team will want to scope out the facility and the security measures in place. In this section, we’ll evaluate some of the ways to circumvent defensive measures by scaling fences, bypassing motion detectors, and cloning a badge.

#### Scaling Fences
Many buildings have ***perimeter security***, such as natural barriers or fences, to deter someone from simply entering the property. The team should walk around the facility and assess whether there are impediments to entrances and other restricted areas that you might be able to go over . In addition, the team can study photographs or Google Earth to examine the property.

If there are fences, the team should evaluate whether or not it would be feasible for someone to try and climb the fence. For example, some fences are only three to four feet high and can easily be scaled. More restrictive premises will likely install taller fences that are difficult to climb over without considerable effort or by using a ladder.

Highly restrictive areas might use extreme security measures in the form of barbed or razor wire at the top of the fence. This is a robust defense method, as even if someone were to manage to scale the fence, they would have a difficult time actually going over it without causing an injury.

> [!warning] Attempting to scale a fence with barbed or razor wire may lead to serious injury.
> 

Once the team has evaluated the facility for barriers or fences, they can make an assessment as to the level of security the defensive methods provide. In addition, they will want to identify where there might be vulnerable areas.

#### Detecting Motion
In addition to fences and barriers, the facility might have ***motion detection*** systems in place. Motion detection sensors are placed in secure areas of the building's along with key entrances and exits to detect movement, monitor activity, and identify unauthorized physical access.

The sensors can use a variety of different technologies to identify motion, but most focus on detecting minute changes in the infrared spectrum. Sensors can range in their ability to detect motion in the following ways:

- Using infrared imaging to detect the presence of a person or object
- Detecting when the infrared pattern is being blocked
- Using algorithms that detect any deviation from an established baseline

Most sensors are placed in ceilings and opposite of each other to cover the widest possible area. If the sensor detects motion, it can trigger an alarm, light, or a fail-safe mechanism, such as activating a ***mantrap***.

The team will want to evaluate the sensors to see if someone can bypass the system and whether or not there are blind spots as you move through a building. In addition, the team can attempt to block the motion detector by using a piece of cardboard or Styrofoam over the sensor.

Motion detectors observe for any activity and provide another layer of security. Another physical security method is by having all personnel wear a badge as they move through the facility. If that is the case, the team may be tasked to see if it is possible to clone a badge to gain access to a building or secure area.

### Cloning a Badge
---
In some facilities, all employees are required to wear a badge so that they can easily be identified. Some badges are simply plastic and have no embedded technology. However, some use a ***radio-frequency identification (RFID)*** badge system for physical security. These badges hold an individual’s authorization credentials and use a ***proximity reader*** that reads data from either an RFID or ***Near-Field Communication (NFC)*** tag when in range.

RFID is a standard for identifying and keeping track of objects' physical locations through the use of radio waves. RFID has many different applications, but in the context of physical security, it is often used with identification badges, and works in the following manner:

1. An RFID tag is attached to the badge and contains an antenna and a microchip.
2. A door lock that contains an RFID reader will continuously send a signal into the area surrounding the reader.
3. The RFID tag's antenna picks up this signal when in close proximity and the microchip generates a return signal.
4. The RFID reader receives this signal and will open the lock if the signal is authenticated.

Unlike a card with a chip or magnetic stripe, an RFID badge does not need to be waved in front of the reader. It simply needs to be within a few feet of the reader, and can be inside of a bag, affixed to someone's shirt, or otherwise physically obstructed. RFID authentication systems can support granular access control with unique badges, allowing only certain badges to open certain locks. Although a badge is technically a "key" to the RFID lock, it helps to mitigate lock picking while still requiring that the user present a specific item for authentication.

If a facility is using a badge system to identify employees, a malicious actor can either steal or clone a badge to circumvent physical security.

***Badge cloning*** is the act of copying authentication data from an RFID badge's microchip to another badge. This can be done through handheld RFID writers, which are inexpensive and easy to use. To clone a badge, complete the following:

1. Hold the badge up to the RFID writer device and press a button to copy the data.
2. Hold a blank badge up to the device and write the copied data to create a cloned badge.

Some badge cloning tools can read the data like any normal RFID reader, that is, the reader can be several feet away and concealed inside a bag.

Keep in mind, badge cloning is most effective on badges that use the 125kHz EM4100 technology. This type of badge does not support encryption and will begin transmitting data to any receivers that are nearby.

Newer RFID badge technology will use higher frequencies that increase the rate at which data can be sent, and most support the use of encryption. These badges only broadcast certain identifying attributes rather than all authentication data on the badge.

Despite the advances in security, these encryption-based badges can still be cloned with the right tools, such as an Android device with NFC capabilities and a cloning app. In addition, certain apps will contain the default encryption keys that are issued by the badge's manufacturer. Many organizations fail to change these keys and, as a result, you can easily copy the badge's data to a new badge through NFC.

The team will want to evaluate the use of badges in a facility. If used, the team can attempt to obtain or clone the badge to see if they can gain access to a facility or secure area.

In addition to circumventing security by scaling fences, bypassing motion detectors and cloning a badge, the team may also need to attempt to gain access using other methods. Let’s evaluate some of these methods, next.

### Gaining Access
---
During a physical security assessment, the team will also evaluate how secure the doors are in the facility. In this section, we’ll evaluate ways to gain access to a secure area by either bypassing locks, tailgating, or piggybacking.

#### Bypassing Locks
Most organizations have at least one door, cabinet, safe, device, or other asset that they will place behind a lock. The team may be tasked to find ways to circumvent these locks in order to achieve your goals. If the team can't even get into an office because the front door is locked, then the physical PenTest will be cut short.

If there is a door lock, the team will need to evaluate the type that is in use, as this will influence the method used to gain access. There are several different types of locks. One of the most common is a standard key lock, which requires the correct key in order for the lock to open. Key locks typically use pin tumblers, interchangeable cores, or wafers under springs used for tension. Bolt cutters and hacksaws may be able to destroy locks that are made from substandard materials or are poorly designed.

Other than physical destruction, you also have the option to pick the lock. ***Lock picking*** uses specialized tools to manipulate the components of a lock in order to gain access to a restricted area. Picking a lock is a skill that requires practice with the right tools. Some vendors sell lock picking kits that come with an array of tools to make the job easier, but you still need to know how to use the tools for them to be effective.

> [!warning] Many lock picking kits are designed to pick pin-tumbler locks and might not be adequate for more advanced, high-security locks, and may require more advanced tools available through companies such as [Covert Instruments](#https://covertinstruments.com/)
> 

The team must keep in mind that not all locks use keys. Keyless locks such as combination locks, access card locks, and biometric scanners must be either destroyed or bypassed. Simple combination locks can be brute-forced with enough permutations, but access card locks and biometric scanners are difficult to bypass without the proper item or biometric profile.

Tailgating and piggybacking are other examples of how you can gain access to a facility as part of a physical attack.

#### Tailgating and Piggybacking
***Tailgating*** is an attack where the malicious actor slips in through a secure area while covertly following an authorized employee who is unaware that anyone is behind them. Tailgating works in the following manner:

1. An employee enters a secure area by using an access card or badge on the locked entrance.
2. The employee opens the door and allows it to close by itself, without checking to see if anyone is behind them.
3. The attacker then quietly moves to the door as its closing and then walks in the secured area.

Tailgating requires several factors to be effective:

- The door must close slowly to allow the tailgater to slip through.
- The tailgated employee isn’t paying attention.
- There is no guard or other personnel on the other side.

***Piggybacking*** is essentially the same thing as tailgating, but in this case, the target knows someone is following behind them. The target might either know the malicious actor personally and be involved somehow, or they might be ignorant of what the attacker is doing.

For example, if the malicious actor was recently terminated from the company, the target might not know this and assume it's just another day at the office. However, it's more likely that the target doesn't know the malicious actor and is just keeping the door open for them out of common courtesy or to avoid confrontation.

Additionally, the malicious actor could carry a large item, such as a package and walk behind the target as they are heading towards the door. The malicious actor can then ask the target to "hold the door" for them to allow them to gain access to a restricted area.

Keep in mind, piggybacking is less effective in smaller organizations where everyone knows all the employees, or in environments where building access is strongly controlled.

The team will want to evaluate whether or not they are able to tailgate or piggyback into a secure area and then note the results.

Next, let’s review ways we can search for information by using methods such as dumpster diving or shoulder surfing.

### Searching for Information
---
In some cases, an organization might not properly dispose of sensitive business documents, storage drives, and computer equipment. In addition, employees may not have been trained in how to make sure that no one is looking over their shoulder. In this section, we’ll investigate ways to discover information by either dumpster diving or shoulder surfing.

Let’s start by seeing what we can find in the trash.

#### Rummaging through Trash
***Dumpster diving*** is the act of searching the contents of trash containers for something of value. In a PenTest, dumpster diving can help you discover documents that contain sensitive information that is relevant to the organization.

By searching through trash, the team may be able to discover actionable intel that can give you an insight into the target's business operations.

Useful discarded items can include:

- **Official documents** : Organizations sometimes improperly dispose of official documents in hard copy, such as past quarterly financial reports or product proposal drafts.
- **Calendars**: In the first few weeks of the year, people often discard their old calendars. The calendar might contain useful information, such as passwords, phone numbers, or contacts.
- **Storage drives**: Organizations sometimes dispose of storage drives, computers, and laptops without properly wiping the data from the device.

Prior to lifting items out of a dumpster, the team needs to keep in mind that this activity can draw suspicion if you're seen. However, many dumpsters are generally placed out of view and away from where people work and require little effort to access. In addition, dumpsters may also be conveniently accessible outside of restricted areas so that external sanitation personnel can pick up the trash without needing to go through a security checkpoint.

In addition to searching through trash to discover useful information, the team can also observe employees at their computers without them noticing.

#### Observing Employees
***Shoulder surfing*** is a social engineering attack in which the malicious actor observes a target's behavior without them noticing. The target is typically at their computer or other device and may be working with sensitive information or inputting their credentials into an authentication system. The malicious actor, who is behind the target, is able to see what's on the screen or the keys they are pressing.

Shoulder surfing doesn't just include someone peering over someone’s shoulder. The malicious actor can accomplish the same thing by using the camera on a smartphone to capture pictures or video at a distance. Or they can set the camera down on a nearby desk, press record, and leave. Using a camera will allow the malicious actor to go back to that recording later and review the targets activity, instead of relying on memory alone.

## Topic 4C - Use Tools to Launch a Social Engineering Attack
---
> [!note] Exam Objectives Covered
> *5.3 Explain use cases of the following tools during the phases of a penetration test.*

Although many social engineering attacks rely on the threat actor’s ability to manipulate someone into completing a task, many times there are technical aspects that are required in order to launch a successful exploit. In this section, we’ll review the Social Engineering Toolkit (SET) and *call spoofing tools* that the team can use during the PenTesting exercise.

Let’s start with an overview of the Social Engineering Toolkit.

### Discovering the SET
---
The ***Social Engineering Toolkit (SET)*** is a _Python_ -based collection of tools that can be used when conducting a social engineering PenTest. You can download SET and install it on a Linux, Unix, and Windows machine or use it within Kali Linux. SET allows you to select from a number of different options that includes attacking websites, mass mailings and Spearphishing attacks.

Once you launch SET, you’ll be presented with a menu that shows you the most common options, as shown in the screenshot below:

![[Pasted image 20240104140752.png]]
*The SET opening menu (Copyright 2020, The Social-Engineer Toolkit (SET) by TrustedSec, LLC.)*

Once in the opening menu, you can make your selection. For example, I selected **`1) Social-Engineering Attacks`**, which brought up the following:

![[Pasted image 20240104140933.png]]
*Selection 1) Social-Engineering Attacks (Copyright 2020, The Social-Engineer Toolkit (SET) by TrustedSec, LLC.)*

SET has a number of options to launch a variety of attacks. In many cases, you will need to provide additional input, such as IP addresses, port numbers, or website URLs. However, when using SET, many of the attacks will walk you through what information is needed, as shown in the screenshot below:

![[Pasted image 20240104141016.png]]
*Stepping through the PowerShell Injection Attack(Copyright 2020, The Social-Engineer Toolkit (SET) by TrustedSec, LLC.)*

Prior to using SET, the team should evaluate the best methods and approach to craft an attack.

One common method used to get someone to answer the phone is by spoofing a phone number so that it appears to be from a trusted source. Let’s see what’s involved.

### Spoofing a Call
---
Today when you make a call from a home line, you are most likely using ***Voice over IP (VoIP)***. VoIP uses the Internet and network to send and receive calls and is slowly replacing the ***Plain Old Telephone System (POTS)***.

On most phones when you get a call, the caller’s identification (Caller ID) will come up on the device so that you can easily identify the caller.

In order to launch a successful social engineering attack, the threat actor needs to appear credible. This is possible because VoIP uses software to make any configuration changes. When making a call, threat actors can spoof the information that is presented to the receiver on the caller ID to appear as if it is coming from a familiar number or location.

When spoofing a call, the malicious actor can make the call appear to be coming from a trusted source, such as:

- A recognized vendor
- A local utility such as the water company
- A remote office
- The president of the company

To spoof a VoIP call, there are a few methods you can use.

1. One method is to use an app where you enter the name and number that you want the receiver to see. The benefit to using an app is there is no extra hardware or software needed. However, in most cases, there is a charge for this type of service.
2. Another method is by using ***Asterisk***, a free, open-source tool to create a spoofed call. Asterisk uses software to create your own ***Private Branch Exchange (PBX)***. Although Asterisk is free, there is more to setting up the system. You will need to be proficient in Linux administration along with having a solid knowledge of networking and scripting.

In addition to using a spoofed phone number to get information, a malicious actor can use the spoofed phone number to listen to voicemail. In some cases, the voicemail system will recognize the phone number and then prompt the user to enter a selection to listen to their voicemail. Or the app will prompt the user to enter a password. If that is the case, the malicious actor will need to use the correct password. If they don’t have the password, they can search online for the default password to try on the targeted system. For example, the search might yield the following:

```
Cisco Unity Voicemail:
The default password for all new accounts on the Haiden Greene voicemail system is HAIGREE or (7995).
```

You can also try some Google Hacking to find more information on VoIP phones that you can use to launch the attack, as shown in the following table:

| **Vendor** | **Advanced Search Option** |
| :--: | ---- |
| *Cisco CallManager:* | **`inurl:"ccmuser/logon.asp"`** |
| *D-Link Phones:* | **`intitle:"D-Link DPH" "web login setting"`** |
| *Grandstream Phones:*  | **`intitle:"Grandstream Device Configuration" password`** |
*Using Google Hacking to find default passwords*

The team will need to evaluate the best approach using information gathered from the footprinting and reconnaissance phase prior to launching an attack using a spoofed phone number.
