## Lesson Introduction
---
Once engaged in a PenTesting exercise, it’s critical to keep the lines of communication open. The team will need to define the communication path, identify essential contacts, and recognize triggers that will prompt an alert or communication event. Because of the compliance requirements, many organizations will need an exact paper trail outlining the results of the PenTest. To aid in this process, many apps have built-in tools for reporting that will help the team distill the information as they ready the formal reports.

## Lesson Objectives
---
In this lesson, you will:

- Identify the communication path and list essential stakeholders that include the primary, technical, and emergency contacts.
- Distinguish communication triggers that include indication of prior compromise and critical findings.
- Use built-in tools for reporting in apps such as Dradis and Nessus and then interpret the results.

## Topic 17A - Define the Communication Path
---
> [!note] Exam Objectives Covered
> *4.3 Explain the importance of communication during the penetration testing process.*

Good communication is essential for the success of the penetration test. Not only must the PenTest team be able to communicate among themselves and with their lead, but the team lead must also be able to communicate with the designated client contact.

Having an escalation path for communications protects PenTesters from having to make risky or potentially damaging decisions. You also want to make sure that communications follow a chain of command.

You should ensure that the PenTest team project supervisor has a counterpart on the client side that they can immediately bring issues to.

You should also agree upon thresholds and protocols for contacting the other side during a problem, including:

- When and how the client will notify the PenTest team that a test is unacceptably interfering with operations/system performance.
- When and how the PenTest team will involve the client IT department if an accident occurs or a system becomes destabilized or unresponsive.

### Outlining the Communication Path
---
In a PenTesting situation, it is equally as important to ensure that the right people are informed as to what information should be shared.

For instance, the organization might not want all staff to know when a PenTest is occurring, particularly if they want to check on the effectiveness of using social engineering tactics to penetrate a network. *The client IT manager and CIO/CISO should be aware of the engagement.* Additionally, some key department managers should also be aware, in case unforeseen incidents affect their departments.

Ensuring that the correct people are informed of the activities is a fine balancing act and must be discussed and planned with your customer carefully. Too little can result in action being taken, or even panic, among your client’s staff. Too much can negate the real-world testing of the attack and measurement of defense responses.

Remember, the client may not care about these issues, and they may want to tell everyone in the company that the attack is coming. Ensure this is discussed thoroughly with the client and agreed in the engagement SOW.

### Communicating with Client Counterparts
---
The designated lead of the PenTesting team should have close communication with their client counterpart (typically the IT manager). To reduce possible confusion, all communication between the PenTesting team and the client should go through these points of contact.

The two lead roles must both be hands-on. This allows for immediate response in case of incidents, unexpected discoveries, additional client requests, or anything else that might lead to extended time or scope creep.

### Defining Contacts
---
The following are the main types of client contacts that you will interact with during a typical PenTesting event:

#### Primary Contact
The primary contact is the party responsible for handling the project on the client’s end. This can usually be a CISO or other party responsible for the major decisions surrounding the penetration test.

#### Technical Contact
The technical contact is the party responsible for handling the technology elements of the activity.

They have a more in-depth knowledge of the technical aspects of the system, the impact of the activities in the client’s network, and what constraints the penetration test might face.

#### Emergency Contact
The emergency contact is the party that can be contacted in case of particularly urgent matters.

In some cases, it can be the same person as, for example, the technical contact. Ideally, the emergency contact should be available 24/7 or at least during the hours that the activity is being performed if done during business hours.

Alternatively, a particular contact is provided to, for example, the organization’s Technical Support that is available 24 hours but can use people who cycle through eight hour shifts.

## Topic 17B - Communication Triggers
---
> [!note] Exam Objectives Covered
> *4.3 Explain the importance of communication during the penetration testing process.*

As with any type of review, whether internal or for hire, communication between the testing team and the stakeholders is of paramount importance.

### Triggering Communication Events
---
All facets of communication need to be evaluated and decided upon, prior to the PenTesting engagement, such as: what information to communicate and when? What should trigger official communications?

Here are a few examples of reasons to initiate communication:

- Status reports are regular progress briefings with the client. If the PenTest will take more than a few days, the client might want regular progress updates. This can be done weekly or as deemed necessary. Keep in mind that "the client" is probably not just one person but could also be several managers who need to remain in the communications loop.

The client may request that these managers each directly receive a copy of status updates, or they may request that reports are given to only one representative who will distribute copies internally. Having a clear communications path will ensure that all relevant parties receive notifications in a timely manner.

Emergencies should be handled separately, although ongoing issues such as client interference, delays, or other problems should be raised at status meetings.

- Critical findings are identified issues that imply a very high risk to the client’s organization. The team should identify findings that are urgent enough to trigger special communications. These commonly refer to high-rated vulnerabilities that, if not addressed as soon as possible, can lead to a major cybersecurity incident.

For example: uncovering an Internet-facing, high-rated vulnerability for which there are known public exploits, and it is actively being exploited by malicious actors.

- Indicators of Prior Compromise are artifacts which can provide evidence of a prior cybersecurity event and could be from malicious sources.

Consider the following: When a PenTester encounters evidence of a compromised system, should the Incident Response Team be notified to ensure that the organization is aware of the attack? If the evidence appears to be "fresh," the PenTest might need to be suspended until the security breach is handled. If it is historical, the PenTest team may instead log the discovery and continue with the task at hand.

- Goal reprioritization is the catalyst for possible adjustments to the engagement.

The nature of a PenTest is that it is a fluid process, and the PenTest team must be able to prioritize findings as they occur. Information that is discovered during the reconnaissance phase drives the decisions on what exploits to try and, ultimately, what solutions to propose.

Awareness of the need for contingency planning for the PenTest engagement itself, enables you to incorporate it into your plans and to reprioritize the goals of one activity or large sections of the PenTest.

### Providing Situational Awareness
---
Consider how a situation might need to be addressed if the PenTest attempt is detected. It is possible that several testers might focus their efforts on a key system at the same time, thus making the breach debilitating or quite obvious. In such a case, the testing team might need to work together to scale back on their efforts to de-escalate the effects of the test.

Another example is when automated tools are used without any rate-limit against a system that is not prepared to handle a large volume of communications. Consider how detrimental it would be for both the entity being assessed and the testing team if the system becomes unstable, or worse, unavailable. In these cases it will be necessary for the PenTester to communicate these situations to the appropriate contacts from the client. Providing situational awareness to key client personnel can also help deconflict the breach, enabling the PenTest to continue so that additional issues can be found, exploited, and analyzed. If the system stays unstable or unavailable, certain situations might arise that will impact the PenTest. If a service crashed, it would not be usable for exploitation and access, or certain techniques might no longer work.

Imagine if the system that crashed and is now unavailable was not the one we were targeting, but an internal one that received said information. Additionally, that was the only system that was visible from our target, which in turn is the only one externally reachable by us. In this scenario, we would not be able to pivot further into the network, greatly impacting the reach of our penetration test.

Here is a diagram visualizing this situation where if the "Only Pivot Candidate" were to become unavailable, it would stop the PenTest:
![[Pasted image 20240627143225.png]]
*Deconflicting issues that impact the reach of the PenTest*

### Recognizing Criminal Activity
---
It is incumbent upon a company to fully disclose vulnerabilities and breaches to their customers, suppliers, regulators, and members of the public who may be harmed by the breach.

If you, the PenTester, were paid to help discover those vulnerabilities and breaches, any findings should be strictly confidential, for both legal and ethical reasons.

An exception to this could be if you uncovered criminal conduct, in which case you might be obligated to notify law enforcement. You should consult with your team's legal counsel for further details.

### Identifying False Positives
---
Automated scans have the potential to produce large numbers of false positives. There are numerous reasons that may trigger the scanner to provide a false positive, including:

- The scanner vendor may be trying to make their product look good by programming the scanner to report more vulnerabilities than there truly are.
- The scanner is unable to recognize that another control is compensating for some identified deficiency.
- The scanner is using a vulnerability database with outdated definitions.
- The scanner incorrectly scores a vulnerability as more severe, or more easily exploited, than it actually is.
- Customizations in the target environment are inadvertently triggering the scanner to identify a vulnerability.
- The scanner is not properly configured; for example, it has been supplied with an incorrect target or credentials.

As a PenTester, you must be able to identify when results indicate a false lead on a vulnerability. Doing so will help you avoid wasting time chasing a lead that takes you to a dead end.

There are several tactics you can employ to identify false positives; one of the most effective is results validation. Through a validation process, you compare what you've learned about the target environment to individual scan results and identify whether or not the results are truly applicable and accurate.

For example, your scanner may indicate that a target Windows Server is susceptible to weaknesses in Server Message Block (SMBv1). However, a past service scan indicates that the SMB service running on the server is patched and running version 3 - the latest. You might therefore conclude that the scanner is in error.

If you were playing the defensive blue team, you'd have an easier time identifying false positives because your understanding of the target environment would be complete.

As a PenTester, there may be gaps in your knowledge, especially if you're conducting an unknown environment test. In this case, you'll need to try your best with what you have and concede that you won't necessarily be able to avoid false positives entirely. You may choose to conduct more reconnaissance on the target environment if you are intent on avoiding as many false positives as possible.

## Topic 17C - Use Built-In Tools for Reporting
---
> [!note] Exam Objectives Covered
> *4.3 Explain the importance of communication during the penetration testing process.*

As you progress through the different phases of your PenTest, you need to keep notes and summarize your results. This can be a time-consuming and laborious job.

In this topic, you will be introduced to several tools that can help you collate information for inclusion in your final PenTest report.

### Presenting the Findings
---
There is not necessarily a unique way to present the findings, especially when tailoring the report to a particular industry for example.

While you are free to improve at will the way you show the findings, it is highly recommended to at least start from a standard, such as PTES (Penetration Testing Execution Standard). In particular for vulnerability scanners, as useful as they are to automate a crucial part of the PenTest, they usually deliver results with a large number of vulnerabilities, but not all are exploitable during the activity.

You might choose to present results in a way that is easily readable and is meaningful. A common way of doing this will be explained further in Lesson 18, but in summary, you should classify and organize vulnerabilities, exploits, and final results.

Here is an example from PTES ( [https://pentest-standard.readthedocs.io/en/latest/reporting.html#technical-report](https://pentest-standard.readthedocs.io/en/latest/reporting.html#technical-report) ) on how to assess and classify vulnerabilities:

- Vulnerability Classification Levels
- Technical Vulnerabilities
- OSI Layer Vulnerabilities
- Scanner Found
- Manually Identified
- Overall Exposure
- Logical Vulnerabilities
- NON OSI Vulnerability
- Type of Vulnerability
- How/Where it is found
- Exposure
- Summary of Results

### Sharing Findings with Dradis
---
The Dradis framework can help to greatly reduce repetition and increase reach by allowing team members to share data and findings about their client organization. This will allow you to not only present the right data (and the right amount) but can also help with the consistency of the report when the different pieces have been actively worked by members from the beginning.

The framework focuses on sharing details about the information gathering phase, useful exploits, and report findings. This ensures, for example, that your team is not missing important areas to scan or that two team members are working on the same exploitation path at the same time.

Example of Dradis' platform:
![[Pasted image 20240627144659.png]]
*An example of Dradis' platform.*

### Building Reports with Nessus
---
Nessus is a well-established vulnerability scanner with a module dedicated to reporting, so it can help with the presentation of findings.

This module can be expanded with the use of templates that define the structure of the report. The objective is to provide consistency, even across different clients, which can help identifying common vulnerabilities and issues found on different infrastructures.

Example of Tenable’s Nessus’ platform:
![[Pasted image 20240627144726.png]]
*An example of Tenable's Nessus' platform.*

Although Nessus was originally open source, it is now under license by Tenable. A free version is still available for download from the company.