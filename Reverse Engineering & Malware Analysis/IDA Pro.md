up:: [[Cybersecurity/Reverse Engineering & Malware Analysis/Software Reverse Engineering (SWRE)]]
up:: [[Cybersecurity/Reverse Engineering & Malware Analysis/x86 Assembly]]
up:: [[Malware Analysis]]

# IDA Pro

IDA Pro (Interactive DisAssembler) is a powerful disassembler and debugger used for reverse engineering software. It converts machine-executable code into assembly language, allowing analysts to understand the program's structure and behavior.

## Key Features

- **Interactive Disassembly**: Converts executable code into human-readable assembly language.
- **Graphical Interface**: Provides a visual representation of the program's control flow.
- **Debugger Integration**: Includes a built-in debugger for dynamic analysis.
- **Extensibility**: Supports plugins and scripts to extend functionality.
- **Cross-Platform Support**: Works with multiple architectures and operating systems.

## Starting IDA

- Load an EXE by either dragging and dropping it onto the icon or opening IDA and selecting the file from the interface.
- Displays a splash screen on startup with version information, licensing, and the edition running.

### File Loading

- **New**: Load a new file for disassembly.
- **Go**: Opens the primary IDA interface without performing disassembly.
- **Previous**: Links to previously opened IDA databases.
- On the "Load a New File" screen, if IDA detects a PE file for Windows, select the default settings and click OK.

## IDA Database Files

- IDA analyzes the executable to create an IDA Database.
- The database is named after the executable being analyzed and uses proprietary databases:
    - `.id0`: Contents of B-tree style database.
    - `.id1`: Flags describing each program byte.
    - `.nam`: Index info about named program locations.
    - `.til`: Information on local type definitions.
- IDA uses the database (`.idb`), not the executable, for analysis.
    - It does not execute the executable.
    - Only the database file is needed for future analysis; the executable is not required.

### Creating an IDA Database

- IDA loads the executable from disk, parsing it to create different sections (code and data).
- Identifies entry points into the code.
- IDA acts like an OS loader, determining the virtual address space for the file.
- Once the loader finishes, the disassembly is created:
    - The disassembly engine processes one address at a time using the selected processor module.
    - The processor module determines:
        - Type of instruction.
        - Length of instruction.
        - Next address (sequential or branching).
- After discovering all instructions, a second pass creates the disassembly.
- During database creation, IDA identifies the compiler, function arguments, local variables, and datatype information.

### Closing IDA Databases

- Saving is crucial:
    - **If you do not save your work, it will not be saved. There is *NO* autosave functionality!**
- Intermediate files should be removed after successfully saving.

## A Successfully Loaded File
---

![[Cybersecurity/_assets/images/IDA-Successful-Loaded-Program.png]]

## IDA Interface
---
![[Cybersecurity/_assets/images/IDA-Interface-and-Layout.png]]

### Interface Overview
---
**Toolbar Area**

![[_assets/images/IDA-Interface-Overview.png]]

- Tabs - Display of all windows currently open. 

**The Functions Window**
![[Cybersecurity/_assets/images/IDA-Functions-Window.png | 350]]

- Renaming requires left-clicking to highlight and then typing `n`. Or, you can right-click it and pick from the drop-down menu.
- Type the new name in the window that pops up. 
- To add a comment, simply go to the appropriate line and hit the colon `:`.
![[Cybersecurity/_assets/images/IDA-Adding-Comments.png]]

- IDA attempts to find Main (Arrow), but if it can't, it will drop you into Start. 

- The Graph Overview - Can be used to change the current View location.

![[_assets/images/IDA-Graph-View.png]]

![[_assets/images/IDA-Library-Identification.png]]

- Display options - **Options --> General**

### Overview Navigator
---
- This provides a **linear view** of the virtual address space for the binary file.

![[_assets/images/IDA-Overview-Navigator.png]]

- Library code can be an endless rabbit hole - You want to spend most of your efforts on Regular Function.

### View-A
---
- The default view is View-A.
- Each box shown depicts a segment of the function.
- This function has three parts.
- The arrows indicate the next segment.
- Segment arrows are color coded:
	- <font style="color: green">Green</font>: Default path.
	- <font style="color: red">Red</font>: Jump condition met path.
	- <font style="color: blue">Blue</font>: No branching, only one path.

![[_assets/images/IDA-View-A.png | 300]]

### Hex View
---
- Allows you to see the raw hex of the EXE alongside ASCII.
- Can be edited to modify the programs behavior.
	- Hit F2 to edit.
	- Changed opcodes will appear in <font style="color: red">red</font>.

![[_assets/images/IDA-Hex-View.png]]

### Opening Views
---
- To open available sub views, click **View --> Open sub-views**. 

![[_assets/images/IDA-Opening-Views.png]]

#### Strings
---
- Can help us discover functionality.

![[_assets/images/IDA-Strings-View.png]]

## Imports and Exports
---
#### Imports:
- These are functions ***NOT*** in the EXE that it **imports** from other modules.

![[_assets/images/IDA-Imports.png]]

#### Exports
- These are functions available to be exported by other programs. 

## Other 
---
- To view all renamed items in the IDA database:
	- View --> Open Subview --> Names window (or Shift-F4) 
-  [How to Find the Location of a String in Memory with the Physical Offset](https://stackoverflow.com/questions/969582/how-to-find-the-location-of-a-string-in-memory-have-the-physical-offset)

## Version 9.0 Patch Guide

![[Cybersecurity/Reverse Engineering & Malware Analysis/IDA Pro 9.0 Patch Guide|IDA Pro 9.0 Patch Guide]]

## Cheat Sheet
![[Cybersecurity/Cheat Sheets/IDA_Pro_Cheat_Sheet.pdf|IDA_Pro_Cheat_Sheet]]
## Revision History

- **2024-09-10**: Entry created.
- **2024-12-5**: Refactored for clarity. 
- **2025-03-18**: Added 9.0 patch guide & cheat sheet. 